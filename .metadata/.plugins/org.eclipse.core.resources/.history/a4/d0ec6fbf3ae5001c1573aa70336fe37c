import java.util.List;

import io.javalin.Javalin;
import pojo.ReimbursementPojo;
import service.ReimbService;
import service.ReimbServiceImpl;


public class ReimbCrud {

	public static void main(String[] args) {

		ReimbService reimbService = new ReimbServiceImpl();

		Javalin server = Javalin.create((config) -> config.enableCorsForAllOrigins());
		server.start(7474);
		
		// endpoint view all requests
		server.get("/reimbursement", (ctx) -> {
			List<ReimbursementPojo> allRequests = reimbService.viewAllRequests();
			ctx.json(allRequests);
		});

		// endpoint submit a request
		server.post("/reimbursement", (ctx) -> {
			ReimbursementPojo newReimbursementPojo = ctx.bodyAsClass(ReimbursementPojo.class);
			ReimbursementPojo returnReimbursementPojo = reimbService.submitRequest(newReimbursementPojo);
			ctx.json(returnReimbursementPojo);
		});
		
		// endpoint view all requests by specific requester
		server.get("/reimbursement/{requesterId}", (ctx) -> {
			List<ReimbursementPojo> allRequestsByRequester = reimbService.viewAllRequestsByRequester(Integer.parseInt(ctx.pathParam("requesterId")));
			ctx.json(allRequestsByRequester);
		});
		
		// endpoint view employee where username = username && password = password
			server.get("/employees", (ctx) -> {
			List<EmployeePojo> allEmployees = reimbService.viewAllEmployees();
			ctx.json(allEmployees);
			});
	}

}
